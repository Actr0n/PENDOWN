<meta charset="utf8"/>
<link rel="stylesheet" href="../pendown.css">
<xmp>
:::
°/*
    This file is part of the Pendown distribution.

    https://github.com/senselogic/PENDOWN

    Copyright (C) 2017 Eric Pelzer (ecstatic.coder\@gmail.com)

    Pendown is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, version 3.

    Pendown is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Pendown.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
*/°

°// == LOCAL°

°// -\- IMPORTS°

¹import¹ core°.°stdc°.°stdlib °:° exit°;°
¹import¹ std°.°ascii °:° isAlpha°,° isDigit°,° isLower°,° isUpper°;°
¹import¹ std°.°conv °:° to°;°
¹import¹ std°.°file °:° readText°,° write°;°
¹import¹ std°.°stdio °:° writeln°;°
¹import¹ std°.°²string² °:° endsWith°,° indexOf°,° join°,° replace°,° split°,° startsWith°,° strip°,° toLower°,° toUpper°;°

°// == GLOBAL°

°// -\- TYPES°

¹class¹ ²²LANGUAGE²²
°{°
    ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °);°
    °}°

    °// ~\~°

    ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ ²false²°;°
    °}°

    °// ~\~°

    ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²C_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"bool"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"signed"²
            °||° code_token°.°Text °==° ²"unsigned"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °||° code_token°.°Text °==° ²"auto"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"sizeof"²
            °||° code_token°.°Text °==° ²"struct"²
            °||° code_token°.°Text °==° ²"union"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"typedef"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"register"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"restrict"²
            °||° code_token°.°Text °==° ²"inline"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"extern"²
            °||° code_token°.°Text °==° ²"asm"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²CPP_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"nullptr"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"bool"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"signed"²
            °||° code_token°.°Text °==° ²"unsigned"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °||° code_token°.°Text °==° ²"auto"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"delete"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"sizeof"²
            °||° code_token°.°Text °==° ²"reinterpret_cast"²
            °||° code_token°.°Text °==° ²"static_cast"²
            °||° code_token°.°Text °==° ²"dynamic_cast"²
            °||° code_token°.°Text °==° ²"using"²
            °||° code_token°.°Text °==° ²"namespace"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"template"²
            °||° code_token°.°Text °==° ²"typename"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"struct"²
            °||° code_token°.°Text °==° ²"union"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"typedef"²
            °||° code_token°.°Text °==° ²"operator"²
            °||° code_token°.°Text °==° ²"virtual"²
            °||° code_token°.°Text °==° ²"final"²
            °||° code_token°.°Text °==° ²"override"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"mutable"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"register"²
            °||° code_token°.°Text °==° ²"explicit"²
            °||° code_token°.°Text °==° ²"friend"²
            °||° code_token°.°Text °==° ²"inline"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"extern"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²CSHARP_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"null"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"bool"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"byte"²
            °||° code_token°.°Text °==° ²"sbyte"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"uint"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"ulong"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °||° code_token°.°Text °==° ²"decimal"²
            °||° code_token°.°Text °==° ²"string"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"foreach"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"finally"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"lock"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"stackalloc"²
            °||° code_token°.°Text °==° ²"sizeof"²
            °||° code_token°.°Text °==° ²"typeof"²
            °||° code_token°.°Text °==° ²"is"²
            °||° code_token°.°Text °==° ²"as"²
            °||° code_token°.°Text °==° ²"params"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"base"²
            °||° code_token°.°Text °==° ²"using"²
            °||° code_token°.°Text °==° ²"namespace"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"interface"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"operator"²
            °||° code_token°.°Text °==° ²"object"²
            °||° code_token°.°Text °==° ²"event"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"in"²
            °||° code_token°.°Text °==° ²"out"²
            °||° code_token°.°Text °==° ²"ref"²
            °||° code_token°.°Text °==° ²"readonly"²
            °||° code_token°.°Text °==° ²"delegate"²
            °||° code_token°.°Text °==° ²"abstract"²
            °||° code_token°.°Text °==° ²"override"²
            °||° code_token°.°Text °==° ²"implicit"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"checked"²
            °||° code_token°.°Text °==° ²"unchecked"²
            °||° code_token°.°Text °==° ²"unsafe"²
            °||° code_token°.°Text °==° ²"fixed"²
            °||° code_token°.°Text °==° ²"sealed"²
            °||° code_token°.°Text °==° ²"internal"²
            °||° code_token°.°Text °==° ²"extern"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²D_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"null"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"bool"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"wchar"²
            °||° code_token°.°Text °==° ²"dchar"²
            °||° code_token°.°Text °==° ²"byte"²
            °||° code_token°.°Text °==° ²"ubyte"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"ushort"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"uint"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"ulong"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °||° code_token°.°Text °==° ²"string"²
            °||° code_token°.°Text °==° ²"wstring"²
            °||° code_token°.°Text °==° ²"dstring"²
            °||° code_token°.°Text °==° ²"auto"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"foreach"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"delete"²
            °||° code_token°.°Text °==° ²"import"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"struct"²
            °||° code_token°.°Text °==° ²"union"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"final"²
            °||° code_token°.°Text °==° ²"override"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²JAVA_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"null"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"boolean"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"byte"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"finally"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"instanceof"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"super"²
            °||° code_token°.°Text °==° ²"import"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"package"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"interface"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"extends"²
            °||° code_token°.°Text °==° ²"implements"²
            °||° code_token°.°Text °==° ²"throws"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"final"²
            °||° code_token°.°Text °==° ²"abstract"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"transient"²
            °||° code_token°.°Text °==° ²"native"²
            °||° code_token°.°Text °==° ²"synchronized"²
            °||° code_token°.°Text °==° ²"strictfp"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²JAVASCRIPT_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"null"²
            °||° code_token°.°Text °==° ²"undefined"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"void"²
            °||° code_token°.°Text °==° ²"boolean"²
            °||° code_token°.°Text °==° ²"char"²
            °||° code_token°.°Text °==° ²"byte"²
            °||° code_token°.°Text °==° ²"short"²
            °||° code_token°.°Text °==° ²"int"²
            °||° code_token°.°Text °==° ²"long"²
            °||° code_token°.°Text °==° ²"float"²
            °||° code_token°.°Text °==° ²"double"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"var"²
            °||° code_token°.°Text °==° ²"let"²
            °||° code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"finally"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"delete"²
            °||° code_token°.°Text °==° ²"yield"²
            °||° code_token°.°Text °==° ²"await"²
            °||° code_token°.°Text °==° ²"eval"²
            °||° code_token°.°Text °==° ²"with"²
            °||° code_token°.°Text °==° ²"in"²
            °||° code_token°.°Text °==° ²"debugger"²
            °||° code_token°.°Text °==° ²"instanceof"²
            °||° code_token°.°Text °==° ²"typeof"²
            °||° code_token°.°Text °==° ²"arguments"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"super"²
            °||° code_token°.°Text °==° ²"import"²
            °||° code_token°.°Text °==° ²"export"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"package"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"interface"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"function"²
            °||° code_token°.°Text °==° ²"extends"²
            °||° code_token°.°Text °==° ²"implements"²
            °||° code_token°.°Text °==° ²"throws"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"final"²
            °||° code_token°.°Text °==° ²"abstract"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"transient"²
            °||° code_token°.°Text °==° ²"native"²
            °||° code_token°.°Text °==° ²"synchronized"²
            °);°
    °}°
°}°

°// ~\~°

¹class¹ ²²TYPESCRIPT_LANGUAGE²² °:° ²²LANGUAGE²²
°{°
    ¹override¹ ²bool² IsConstant°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"false"²
            °||° code_token°.°Text °==° ²"true"²
            °||° code_token°.°Text °==° ²"null"²
            °||° code_token°.°Text °==° ²"undefined"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsType°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"boolean"²
            °||° code_token°.°Text °==° ²"number"²
            °||° code_token°.°Text °==° ²"string"²
            °||° code_token°.°Text °==° ²"symbol"²
            °||° code_token°.°Text °==° ²"any"²
            °);°
    °}°

    °// ~\~°

    ¹override¹ ²bool² IsKeyword°(°
        ²²CODE_TOKEN²² code_token
        °)°
    °{°
        ¹return¹ °(°
            code_token°.°Text °==° ²"var"²
            °||° code_token°.°Text °==° ²"let"²
            °||° code_token°.°Text °==° ²"if"²
            °||° code_token°.°Text °==° ²"else"²
            °||° code_token°.°Text °==° ²"do"²
            °||° code_token°.°Text °==° ²"while"²
            °||° code_token°.°Text °==° ²"for"²
            °||° code_token°.°Text °==° ²"switch"²
            °||° code_token°.°Text °==° ²"case"²
            °||° code_token°.°Text °==° ²"default"²
            °||° code_token°.°Text °==° ²"break"²
            °||° code_token°.°Text °==° ²"continue"²
            °||° code_token°.°Text °==° ²"return"²
            °||° code_token°.°Text °==° ²"goto"²
            °||° code_token°.°Text °==° ²"try"²
            °||° code_token°.°Text °==° ²"catch"²
            °||° code_token°.°Text °==° ²"finally"²
            °||° code_token°.°Text °==° ²"throw"²
            °||° code_token°.°Text °==° ²"new"²
            °||° code_token°.°Text °==° ²"delete"²
            °||° code_token°.°Text °==° ²"yield"²
            °||° code_token°.°Text °==° ²"await"²
            °||° code_token°.°Text °==° ²"eval"²
            °||° code_token°.°Text °==° ²"with"²
            °||° code_token°.°Text °==° ²"in"²
            °||° code_token°.°Text °==° ²"debugger"²
            °||° code_token°.°Text °==° ²"instanceof"²
            °||° code_token°.°Text °==° ²"typeof"²
            °||° code_token°.°Text °==° ²"arguments"²
            °||° code_token°.°Text °==° ²"this"²
            °||° code_token°.°Text °==° ²"super"²
            °||° code_token°.°Text °==° ²"import"²
            °||° code_token°.°Text °==° ²"export"²
            °||° code_token°.°Text °==° ²"public"²
            °||° code_token°.°Text °==° ²"protected"²
            °||° code_token°.°Text °==° ²"private"²
            °||° code_token°.°Text °==° ²"package"²
            °||° code_token°.°Text °==° ²"class"²
            °||° code_token°.°Text °==° ²"interface"²
            °||° code_token°.°Text °==° ²"enum"²
            °||° code_token°.°Text °==° ²"function"²
            °||° code_token°.°Text °==° ²"constructor"²
            °||° code_token°.°Text °==° ²"extends"²
            °||° code_token°.°Text °==° ²"implements"²
            °||° code_token°.°Text °==° ²"static"²
            °||° code_token°.°Text °==° ²"const"²
            °||° code_token°.°Text °==° ²"abstract"²
            °||° code_token°.°Text °==° ²"volatile"²
            °||° code_token°.°Text °==° ²"transient"²
            °||° code_token°.°Text °==° ²"native"²
            °||° code_token°.°Text °==° ²"synchronized"²
            °);°
    °}°
°}°

°// ~\~°

¹enum¹ ²²CODE_TOKEN_TYPE²²
°{°
    None°,°
    ShortComment°,°
    LongComment°,°
    String°,°
    Number°,°
    Constant°,°
    Type°,°
    Keyword°,°
    Pragma°,°
    LowerCaseIdentifier°,°
    UpperCaseIdentifier°,°
    MinorCaseIdentifier°,°
    MajorCaseIdentifier°,°
    Identifier°,°
    Operator°,°
    Separator°,°
    Delimiter°,°
    Special°,°
    Spacing°,°
    Count
°}°

°// ~\~°

¹class¹ ²²CODE_TOKEN²²
°{°
    ²²CODE_TOKEN_TYPE²²
        Type°;°
    ²dstring²
        Text°;°
°}°

°// ~\~°

¹class¹ ²²TOKEN²²
°{°
    ²dstring²
        Text°;°
    ²bool²
        StartsLine°,°
        IsSpace°,°
        IsEscaped°;°
°}°

°// -\- VARIABLES°

²bool²
    ColorizeOptionIsEnabled°,°
    PageOptionIsEnabled°,°
    ProcessOptionIsEnabled°,°
    ScriptOptionIsEnabled°,°
    StyleOptionIsEnabled°;°
²double²
    PageBottomMargin°,°
    PageHeight°,°
    PageLeftMargin°,°
    PageRightMargin°,°
    PageTopMargin°,°
    PageWidth°;°
²long²
    IndentationSpaceCount°,°
    TabulationSpaceCount°;°
²string²
    InputFilePath°,°
    LanguageName°,°
    OutputFilePath°,°
    ScriptFolderPath°,°
    StyleFolderPath°;°
²dstring²°[° ²dstring² °]°
    DefinitionMap°;°

°// -\- FUNCTIONS°

²void² PrintError°(°
    ²string² message
    °)°
°{°
    writeln°(° ²"*\*\* ERROR : "²°,° message °);°
°}°

°// ~\~°

²void² Abort°(°
    ²string² message
    °)°
°{°
    PrintError°(° message °);°

    exit°(° ²-1² °);°
°}°

°// ~\~°

²dchar² charAt°(°
    ²dstring² text°,°
    ²long² character_index
    °)°
°{°
    ¹return¹ text°[° character_index °];°
°}°

°// ~\~°

²dstring² slice°(°
    ²dstring² text°,°
    ²long² first_character_index°,°
    ²long² post_character_index
    °)°
°{°
    ¹if¹ °(° first_character_index °&lt;° ²0² °)°
    °{°
        first_character_index °+=° text°.°length°;°
    °}°

    ¹if¹ °(° post_character_index °&lt;° ²0² °)°
    °{°
        post_character_index °+=° text°.°length°;°
    °}°

    ¹if¹ °(° first_character_index °&gt;° text°.°length °)°
    °{°
        first_character_index °=° text°.°length°;°
    °}°

    ¹if¹ °(° post_character_index °&gt;° text°.°length °)°
    °{°
        post_character_index °=° text°.°length°;°
    °}°


    ¹return¹ text°[° first_character_index °..° post_character_index °];°
°}°

°// ~\~°

²dstring² trim°(°
    ²dstring² text
    °)°
°{°
    ¹return¹ text°.°strip°();°
°}°

°// ~\~°

²void² splice°(° ²²ELEMENT²² °)(°
    ref ²²ELEMENT²²°[]° element_array°,°
    ²long² element_index°,°
    ²long² element_count°,°
    ²²ELEMENT²² element
    °)°
°{°
    element_array °=° element_array°[° ²0² °..° element_index °]° °~° element °~° element_array°[° element_index °+° element_count °..° °$° °];°
°}°

°// ~\~°

²void² push°(° ²²ELEMENT²² °)(°
    ref ²²ELEMENT²²°[]° element_array°,°
    ²²ELEMENT²² element
    °)°
°{°
    element_array °~=° element°;°
°}°

°// ~\~°

²²ELEMENT²² pop°(° ²²ELEMENT²² °)(°
    ref ²²ELEMENT²²°[]° element_array
    °)°
°{°
    ²²ELEMENT²²
        element°;°

    element °=° element_array°[° °$° °-° ²1² °];°

    element_array °=° element_array°[° ²0² °..° °$° °-° ²1² °];°

    ¹return¹ element°;°
°}°

°// ~\~°

²dstring² ReplaceTabulations°(°
    ²dstring² text
    °)°
°{°
    ²dchar²
        character°;°
    ²dstring²
        replaced_text°;°
    ²long²
        character_index°,°
        line_character_index°;°
        
    text °=° text°.°replace°(° ²"\\t\\t"²°,° ²"\\t    "² °).°replace°(° ²"\\n\\t"²°,° ²"\\n    "² °);°

    ¹if¹ °(° text°.°indexOf°(° ²'\\t'² °)° °&gt;=° ²0² °)°
    °{°
        replaced_text °=° ²""²°;°

        line_character_index °=° ²0²°;°
        
        ¹for¹ °(° character_index °=° ²0²°;°
              character_index °&lt;° text°.°length°;°
              °+\+°character_index °)°
        °{°
            character °=° text°.°charAt°(° character_index °);°
            
            ¹if¹ °(° character °==° ²'\\t'² °)°
            °{°
                ¹do¹
                °{°
                    replaced_text °~=° ²' '²°;°
                    
                    °+\+°line_character_index°;°
                °}°
                ¹while¹ °(° °(° line_character_index °%° TabulationSpaceCount °)° °\!=° ²0² °);°
            °}°
            ¹else¹
            °{°
                replaced_text °~=° character°;°
                
                ¹if¹ °(° character °==° ²'\\n'² °)°
                °{°
                    line_character_index °=° ²0²°;°
                °}°
                ¹else¹
                °{°
                    °+\+°line_character_index°;°
                °}°
            °}°
        °}°
        
        ¹return¹ replaced_text°;°
    °}°
    ¹else¹
    °{°
        ¹return¹ text°;°
    °}°
°}°

°// ~\~°

²dstring² GetCleanedText°(°
    ²dstring² text
    °)°
°{°
    ²dstring²
        cleaned_text°;°
        
    cleaned_text °=° ReplaceTabulations°(° text °).°replace°(° ²"\\r"²°,° ²""² °);°

    ¹if¹ °(° °\!°cleaned_text°.°endsWith°(° ²'\\n'² °)° °)°
    °{°
        cleaned_text °~=° ²'\\n'²°;°
    °}°

    ¹return¹ cleaned_text°;°    
°}°

°// ~\~°

²bool² IsAlphabeticalCharacter°(°
    ²dchar² character
    °)°
°{°
    ¹return¹ °(°
        °(° character °&gt;=° ²'a'² °&&° character °&lt;=° ²'z'² °)°
        °||° °(° character °&gt;=° ²'A'² °&&° character °&lt;=° ²'Z'² °)°
        °);°
°}°

°// ~\~°

²bool² IsDecimalCharacter°(°
    ²dchar² character
    °)°
°{°
    ¹return¹ character °&gt;=° ²'0'² °&&° character °&lt;=° ²'9'²°;°
°}°

°// ~\~°

²bool² IsHexadecimalCharacter°(°
    ²dchar² character
    °)°
°{°
    ¹return¹ °(°
        °(° character °&gt;=° ²'0'² °&&° character °&lt;=° ²'9'² °)°
        °||° °(° character °&gt;=° ²'a'² °&&° character °&lt;=° ²'f'² °)°
        °||° °(° character °&gt;=° ²'A'² °&&° character °&lt;=° ²'F'² °)°
        °);°
°}°

°// ~\~°

²²LANGUAGE²² GetLanguage°(°
    ²string² file_path°,°
    ²string² file_extension
    °)°
°{°
    ¹if¹ °(° file_extension °\!=° ²""² °)°
    °{°
        ¹if¹ °(° file_extension°.°startsWith°(° ²'.'² °)° °)°
        °{°
            file_path °=° file_extension°;°
        °}°
        ¹else¹
        °{°
            file_path °=° ²"."² °~° file_extension°;°
        °}°
    °}°

    ¹if¹ °(° file_path°.°endsWith°(° ²".c"² °)°
         °||° file_path°.°endsWith°(° ²".h"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²C_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".c+\+"² °)°
              °||° file_path°.°endsWith°(° ²".h+\+"² °)°
              °||° file_path°.°endsWith°(° ²".cpp"² °)°
              °||° file_path°.°endsWith°(° ²".hpp"² °)°
              °||° file_path°.°endsWith°(° ²".cxx"² °)°
              °||° file_path°.°endsWith°(° ²".hxx"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²CPP_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".c\#"² °)°
              °||° file_path°.°endsWith°(° ²".cs"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²CSHARP_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".d"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²D_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".java"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²JAVA_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".js"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²JAVASCRIPT_LANGUAGE²²°;°
    °}°
    ¹else¹ ¹if¹ °(° file_path°.°endsWith°(° ²".ts"² °)° °)°
    °{°
        ¹return¹ ¹new¹ ²²TYPESCRIPT_LANGUAGE²²°;°
    °}°
    ¹else¹
    °{°
        ¹return¹ ¹new¹ ²²LANGUAGE²²°;°
    °}°
°}°

°// ~\~°

²²CODE_TOKEN²²°[]° GetCodeTokenArray°(°
    ²dstring² text°,°
    ²²LANGUAGE²² language
    °)°
°{°
    ²dchar²
        character°,°
        delimiter_character°,°
        next_character°;°
    ²long²
        character_index°;°
    ²²CODE_TOKEN²²
        code_token°;°
    ²²CODE_TOKEN²²°[]°
        code_token_array°;°

    text °=° GetCleanedText°(° text °);°

    code_token_array °=° °[];°

    code_token °=° ²null²°;°
    delimiter_character °=° ²0²°;°

    ¹for¹ °(° character_index °=° ²0²°;°
          character_index °&lt;=° text°.°length°;°
          °+\+°character_index °)°
    °{°
        ¹if¹ °(° character_index °&lt;° text°.°length °)°
        °{°
            character °=° text°.°charAt°(° character_index °);°
        °}°
        ¹else¹
        °{°
            character °=° ²0²°;°
        °}°

        ¹if¹ °(° character_index °+° ²1² °&lt;° text°.°length °)°
        °{°
            next_character °=° text°.°charAt°(° character_index °+° ²1² °);°
        °}°
        ¹else¹
        °{°
            next_character °=° ²0²°;°
        °}°

        ¹if¹ °(° code_token °\!°is ²null² °)°
        °{°
            ¹if¹ °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°String °)°
            °{°
                ¹if¹ °(° character °==° delimiter_character °)°
                °{°
                    code_token°.°Text °~=° character°;°

                    code_token °=° ²null²°;°
                    character °=° ²0²°;°
                °}°
                ¹else¹ ¹if¹ °(° character °==° ²'\\\\'² °)°
                °{°
                    code_token°.°Text °~=° character°;°
                    code_token°.°Text °~=° next_character°;°

                    character °=° ²0²°;°

                    °+\+°character_index°;°
                °}°
                ¹else¹
                °{°
                    code_token°.°Text °~=° character°;°
                °}°
            °}°
            ¹else¹ ¹if¹ °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°ShortComment °)°
            °{°
                ¹if¹ °(° character °==° ²'\\r'²
                     °||° character °==° ²'\\n'² °)°
                °{°
                    code_token °=° ²null²°;°
                °}°
                ¹else¹
                °{°
                    code_token°.°Text °~=° character°;°
                °}°
            °}°
            ¹else¹ ¹if¹ °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°LongComment °)°
            °{°
                ¹if¹ °(° character °==° ²'*'²
                     °&&° next_character °==° ²'/'² °)°
                °{°
                    code_token°.°Text °~=° ²"*/"²°;°

                    code_token °=° ²null²°;°
                    character °=° ²0²°;°

                    °+\+°character_index°;°
                °}°
                ¹else¹
                °{°
                    code_token°.°Text °~=° character°;°
                °}°
            °}°
            ¹else¹ ¹if¹ °(° °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°Number
                        °&&° °(° character°.°isDigit°()°
                             °||° °(° character °==° ²'.'² °&&° next_character°.°isDigit°()° °)°
                             °||° character°.°isAlpha°()° °)° °)°
                      °||° °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°Identifier
                           °&&° °(° character°.°isAlpha°()°
                                °||° character°.°isDigit°()°
                                °||° character °==° ²'_'² °)° °)°
                      °||° °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°Operator
                           °&&° ²"~+-*/%^$&|?:\!=&lt;&gt;\#"²°.°indexOf°(° character °)° °&gt;=° ²0² °)° °)°
            °{°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹
            °{°
                ¹if¹ °(° code_token°.°Type °==° ²²CODE_TOKEN_TYPE²²°.°Identifier °)°
                °{°
                    ¹if¹ °(° language°.°IsConstant°(° code_token °)° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Constant°;°
                    °}°
                    ¹else¹ ¹if¹ °(° language°.°IsType°(° code_token °)° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Type°;°
                    °}°
                    ¹else¹ ¹if¹ °(° language°.°IsKeyword°(° code_token °)° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Keyword°;°
                    °}°
                    ¹else¹ ¹if¹ °(° code_token°.°Text°.°startsWith°(° ²'\#'² °)° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Pragma°;°
                    °}°
                    ¹else¹ ¹if¹ °(° code_token°.°Text °==° code_token°.°Text°.°toLower°()° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°LowerCaseIdentifier°;°
                    °}°
                    ¹else¹ ¹if¹ °(° code_token°.°Text °==° code_token°.°Text°.°toUpper°()°
                              °&&° code_token°.°Text°.°length °&gt;=° ²2² °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°UpperCaseIdentifier°;°
                    °}°
                    ¹else¹ ¹if¹ °(° code_token°.°Text°[° ²0² °].°isLower°()° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°MinorCaseIdentifier°;°
                    °}°
                    ¹else¹ ¹if¹ °(° code_token°.°Text°[° ²0² °].°isUpper°()° °)°
                    °{°
                        code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°MajorCaseIdentifier°;°
                    °}°
                °}°

                code_token °=° ²null²°;°
            °}°
        °}°

        ¹if¹ °(° code_token is ²null²
             °&&° character °\!=° ²0² °)°
        °{°
            code_token °=° ¹new¹ ²²CODE_TOKEN²²°;°

            ¹if¹ °(° character °==° ²'/'²
                 °&&° next_character °==° ²'/'² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°ShortComment°;°
                code_token°.°Text °=° ²"//"²°;°

                °+\+°character_index°;°
            °}°
            ¹else¹ ¹if¹ °(° character °==° ²'/'²
                      °&&° next_character °==° ²'*'² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°LongComment°;°
                code_token°.°Text °=° ²"/*"²°;°

                °+\+°character_index°;°
            °}°
            ¹else¹ ¹if¹ °(° character °==° ²'\\''²
                      °||° character °==° ²'\\"'²
                      °||° character °==° ²'\`'² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°String°;°
                code_token°.°Text °~=° character°;°

                delimiter_character °=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° character°.°isDigit°()°
                      °||° °(° character °==° ²'-'²
                           °&&° next_character°.°isDigit°()° °)° °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Number°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° character°.°isAlpha°()°
                      °||° character °==° ²'_'²
                      °||° °(° character °==° ²'\#'² °&&° next_character°.°isAlpha°()° °)° °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Identifier°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° ²"~+-*/%^$&|\!=&lt;&gt;\#"²°.°indexOf°(° character °)° °&gt;=° ²0² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Operator°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° ²".,;"²°.°indexOf°(° character °)° °&gt;=° ²0² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Separator°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° ²"()[]{}"²°.°indexOf°(° character °)° °&gt;=° ²0² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Delimiter°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹ ¹if¹ °(° ²" \\t\\r\\n"²°.°indexOf°(° character °)° °&gt;=° ²0² °)°
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Spacing°;°
                code_token°.°Text °~=° character°;°
            °}°
            ¹else¹
            °{°
                code_token°.°Type °=° ²²CODE_TOKEN_TYPE²²°.°Special°;°
                code_token°.°Text °~=° character°;°
            °}°

            code_token_array°.°push°(° code_token °);°

            ¹if¹ °(° code_token°.°Type °&gt;=° ²²CODE_TOKEN_TYPE²²°.°Separator °)°
            °{°
                code_token °=° ²null²°;°
            °}°
        °}°
    °}°

    ¹return¹ code_token_array°;°
°}°

°// ~\~°

²void² EscapeSpecialCharacters°(°
    ref ²²CODE_TOKEN²²°[]° code_token_array
    °)°
°{°
    ²dchar²
        character°,°
        prior_character°;°
    ²dstring²
        code_token_text°;°
    ²long²
        character_index°,°
        code_token_index°;°
    ²²CODE_TOKEN²²
        code_token°;°

    ¹for¹ °(° code_token_index °=° ²0²°;°
          code_token_index °&lt;° code_token_array°.°length°;°
          °+\+°code_token_index °)°
    °{°
        code_token °=° code_token_array°[° code_token_index °];°

        code_token_text °=° ²""²°;°
        prior_character °=° ²0²°;°

        ¹for¹ °(° character_index °=° ²0²°;°
              character_index °&lt;° code_token°.°Text°.°length°;°
              °+\+°character_index °)°
        °{°
            character °=° code_token°.°Text°.°charAt°(° character_index °);°

            ¹if¹ °(° character °==° ²'&lt;'² °)°
            °{°
                code_token_text °~=° ²"&lt;"²°;°
            °}°
            ¹else¹ ¹if¹ °(° character °==° ²'&gt;'² °)°
            °{°
                code_token_text °~=° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                ¹if¹ °(° ²"\\\\\`\°\¹\²\³\!\#\@"²°.°indexOf°(° character °)° °&gt;=° ²0²
                     °||° °(° ²"+-$*%^,~_{}[]:"²°.°indexOf°(° character °)° °&gt;=° ²0²
                          °&&° character °==° prior_character °)° °)°
                °{°
                    code_token_text °~=° ²'\\\\'²°;°
                °}°

                code_token_text °~=° character°;°
            °}°

            prior_character °=° character°;°
        °}°

        code_token°.°Text °=° code_token_text°;°
    °}°
°}°

°// ~\~°

²dstring² GetColorizedText°(°
    ²dstring² text°,°
    ²string² file_path°,°
    ²string² file_extension
    °)°
°{°
    ²dstring²
        colorized_text°;°
    ²dstring²°[° ²²CODE_TOKEN_TYPE²²°.°Count °]°
        color_prefix_array°,°
        color_suffix_array°;°
    ²int²
        code_token_index°;°
    ²²LANGUAGE²²
        language°;°
    ²²CODE_TOKEN²²
        code_token°;°
    ²²CODE_TOKEN²²°[]°
        code_token_array°;°

    language °=° GetLanguage°(° file_path°,° file_extension °);°

    text °=° GetCleanedText°(° text °);°

    code_token_array °=° GetCodeTokenArray°(° text°,° language °);°

    EscapeSpecialCharacters°(° code_token_array °);°

    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°ShortComment °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°LongComment °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°String °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Number °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Constant °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Type °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Keyword °]° °=° ²"\¹"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Pragma °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°LowerCaseIdentifier °]° °=° ²""²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°UpperCaseIdentifier °]° °=° ²"\²\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°MinorCaseIdentifier °]° °=° ²""²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°MajorCaseIdentifier °]° °=° ²""²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Identifier °]° °=° ²"\²"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Operator °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Separator °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Delimiter °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Special °]° °=° ²"\°"²°;°
    color_prefix_array°[° ²²CODE_TOKEN_TYPE²²°.°Spacing °]° °=° ²""²°;°

    color_suffix_array °=° color_prefix_array°;°

    colorized_text °=° ²":\:\:\\n"²°;°

    ¹for¹ °(° code_token_index °=° ²0²°;°
          code_token_index °&lt;° code_token_array°.°length°;°
          °+\+°code_token_index °)°
    °{°
        code_token °=° code_token_array°[° code_token_index °];°

        ¹if¹ °(° code_token_index °==° ²0²
             °||° color_prefix_array°[° code_token°.°Type °]°
                °\!=° color_prefix_array°[° code_token_array°[° code_token_index °-° ²1² °].°Type °]° °)°
        °{°
            colorized_text °~=° color_prefix_array°[° code_token°.°Type °];°
        °}°

        colorized_text °~=° code_token°.°Text°;°

        ¹if¹ °(° code_token_index °==° code_token_array°.°length°.°to°\!°²long²°()° °-° ²1²
             °||° color_suffix_array°[° code_token°.°Type °]°
                °\!=° color_suffix_array°[° code_token_array°[° code_token_index °+° ²1² °].°Type °]° °)°
        °{°
            colorized_text °~=° color_suffix_array°[° code_token°.°Type °];°
        °}°
    °}°

    colorized_text °~=° ²":\:\:\\n"²°;°

    ¹return¹ colorized_text°;°
°}°

°// ~\~°

²dstring² GetPreprocessedText°(°
    ²dstring² text
    °)°
°{°
    ²dstring²
        code_line°,°
        code_text°,°
        line°;°
    ²dstring²°[]°
        code_line_array°,°
        line_array°;°
    ²int²
        code_line_index°,°
        line_index°,°
        post_line_index°;°
    ²string²
        file_extension°;°

    text °=° GetCleanedText°(° text °);°

    line_array °=° text°.°split°(° ²'\\n'² °);°

    ¹for¹ °(° line_index °=° ²0²°;°
          line_index °&lt;° line_array°.°length°;°
          °+\+°line_index °)°
    °{°
        line °=° line_array°[° line_index °].°trim°();°
        
        ¹if¹ °(° line °==° ²""² °)°
        °{°
            line_array°[° line_index °]° °=° ²""²°;°
        °}°
        ¹else¹ ¹if¹ °(° line°.°startsWith°(° ²":\:\:"² °)° °)°
        °{°
            ¹if¹ °(° line °==° ²":\:\:c\\\\"²
                 °||° line °==° ²":\:\:h\\\\"²
                 °||° line °==° ²":\:\:c+\+\\\\"²
                 °||° line °==° ²":\:\:h+\+\\\\"²
                 °||° line °==° ²":\:\:cpp\\\\"²
                 °||° line °==° ²":\:\:hpp\\\\"²
                 °||° line °==° ²":\:\:cxx\\\\"²
                 °||° line °==° ²":\:\:hxx\\\\"²
                 °||° line °==° ²":\:\:c\#\\\\"²
                 °||° line °==° ²":\:\:cs\\\\"²
                 °||° line °==° ²":\:\:d\\\\"²
                 °||° line °==° ²":\:\:java\\\\"²
                 °||° line °==° ²":\:\:js\\\\"²
                 °||° line °==° ²":\:\:ts\\\\"² °)°
            °{°
                file_extension °=° line°.°slice°(° ²3²°,° ²-1² °).°to°\!°²string²°();°

                code_text °=° ²""²°;°

                ¹for¹ °(° post_line_index °=° line_index °+° ²1²°;°
                      post_line_index °&lt;° line_array°.°length°;°
                      °+\+°post_line_index °)°
                °{°
                    code_line °=° line_array°[° post_line_index °];°

                    ¹if¹ °(° code_line°.°trim°()° °==° ²":\:\:"² °)°
                    °{°
                        ¹break¹°;°
                    °}°
                    ¹else¹
                    °{°
                        code_text °~=° code_line°;°
                        code_text °~=° ²'\\n'²°;°
                    °}°
                °}°

                ¹if¹ °(° code_text °\!=° ²""² °)°
                °{°
                    code_text °=° GetColorizedText°(° code_text°,° ²""²°,° file_extension °);°

                    code_line_array °=° code_text°.°split°(° ²'\\n'² °);°

                    ¹for¹ °(° code_line_index °=° ²0²°;°
                          code_line_index °&lt;° code_line_array°.°length
                          °&&° line_index °&lt;° post_line_index°;°
                          °+\+°code_line_index °)°
                    °{°
                        line_array°[° line_index °]° °=° code_line_array°[° code_line_index °];°

                        °+\+°line_index°;°
                    °}°
                °}°
            °}°
        °}°
    °}°

    text °=° line_array°.°join°(° ²'\\n'² °);°

    ¹return¹ text°;°
°}°

°// ~\~°

²bool² HasUnit°(°
    ²dstring² size
    °)°
°{°
    ¹return¹ °(°
        size °==° ²"auto"²
        °||° size°.°endsWith°(° ²"%"² °)°
        °||° size°.°endsWith°(° ²"ch"² °)°
        °||° size°.°endsWith°(° ²"cm"² °)°
        °||° size°.°endsWith°(° ²"em"² °)°
        °||° size°.°endsWith°(° ²"ex"² °)°
        °||° size°.°endsWith°(° ²"in"² °)°
        °||° size°.°endsWith°(° ²"mm"² °)°
        °||° size°.°endsWith°(° ²"pc"² °)°
        °||° size°.°endsWith°(° ²"pt"² °)°
        °||° size°.°endsWith°(° ²"px"² °)°
        °||° size°.°endsWith°(° ²"rem"² °)°
        °||° size°.°endsWith°(° ²"vh"² °)°
        °||° size°.°endsWith°(° ²"vmax"² °)°
        °||° size°.°endsWith°(° ²"vmin"² °)°
        °||° size°.°endsWith°(° ²"vw"² °)°
        °);°
°}°

°// ~\~°

²²TOKEN²²°[]° GetTokenArray°(°
    ²dstring² text
    °)°
°{°
    ²bool²
        it_is_in_a°,°
        it_is_in_b°,°
        it_is_in_blockquote°,°
        it_is_in_black_span°,°
        it_is_in_blue_span°,°
        it_is_in_box_div°,°
        it_is_in_center_div°,°
        it_is_in_cyan_span°,°
        it_is_in_frame_div°,°
        it_is_in_gray_span°,°
        it_is_in_green_span°,°
        it_is_in_i°,°
        it_is_in_left_div°,°
        it_is_in_mark_span°,°
        it_is_in_orange_span°,°
        it_is_in_pink_span°,°
        it_is_in_pre°,°
        it_is_in_red_span°,°
        it_is_in_right_div°,°
        it_is_in_strike°,°
        it_is_in_sup°,°
        it_is_in_sub°,°
        it_is_in_u°,°
        token_starts_line°;°
    ²dstring²
        attributes°,°
        closing_tag°,°
        url°;°
    ²long²
        character_index°,°
        table_count°,°
        token_character_index°;°
    ²²TOKEN²²
        closing_token°,°
        token°;°
    ²²TOKEN²²°[]°
        token_array°;°

    °// ~\~°
    
    ²dstring² ParseImage°(°
        °)°
    °{°
        ²bool²
            size_is_parsed°;°
        ²dchar²
            character°;°
        ²dstring²
            height°,°
            image_text°,°
            size_text°,°
            width°;°
        ²dstring²°[]°
            size_array°;°

        character_index °+=° ²2²°;°

        image_text °=° ²"&lt;img src=\\""²°;°
        size_text °=° ²""²°;°
        size_is_parsed °=° ²false²°;°
        
        ¹while¹ °(° character_index °&lt;° text°.°length °)°
        °{°
            character °=° text°.°charAt°(° character_index °);°
            
            ¹if¹ °(° character °==° ²'\\\\'²
                 °&&° character_index °+° ²1² °&lt;° text°.°length °)°
            °{°
                °+\+°character_index°;°
                
                image_text °~=° text°.°charAt°(° character_index °);°
            °}°
            ¹else¹ ¹if¹ °(° character °==° ²']'²
                      °&&° character_index °+° ²1² °&lt;° text°.°length
                      °&&° text°.°charAt°(° character_index °+° ²1² °)° °==° ²']'² °)°
            °{°
                character_index °+=° ²2²°;°
                
                ¹break¹°;°
            °}°
            ¹else¹ ¹if¹ °(° size_is_parsed °)°
            °{°
                size_text °~=° character°;°
            °}°
            ¹else¹
            °{°
                ¹if¹ °(° character °==° ²':'² °)°
                °{°
                    size_is_parsed °=° ²true²°;°
                °}°
                ¹else¹ ¹if¹ °(° character °==° ²'\\"'² °)°
                °{°
                    image_text °~=° ²"&quot;"²°;°
                °}°
                ¹else¹
                °{°
                    image_text °~=° character°;°
                °}°
            °}°
            
            °+\+°character_index°;°
        °}°
        
        ¹if¹ °(° size_text °==° ²""² °)°
        °{°
            size_text °=° ²",100"²°;°
        °}°
     
        size_array °=° size_text°.°split°(° ²','² °);°
        
        ¹if¹ °(° size_array°.°length °==° ²1² °)°
        °{°
            height °=° size_array°[° ²0² °];°
            width °=° ²""²°;°
        °}°
        ¹else¹ ¹if¹ °(° size_array°.°length °==° ²2² °)°
        °{°
            height °=° size_array°[° ²0² °];°
            width °=° size_array°[° ²1² °];°
        °}°
        ¹else¹
        °{°
            height °=° ²""²°;°
            width °=° ²"100"²°;°
        °}°
        
        ¹if¹ °(° height °==° ²""² °)°
        °{°
            height °=° ²"auto"²°;°
        °}°
        ¹else¹ ¹if¹ °(° °\!°HasUnit°(° height °)° °)°
        °{°
            ¹if¹ °(° PageOptionIsEnabled °)°
            °{°
                height 
                    °=° °(° height°.°to°\!°²double²°()° 
                        °*° °(° PageWidth °-° PageLeftMargin °-° PageRightMargin °)° 
                        °/° °(° PageHeight °-° PageTopMargin °-° PageBottomMargin °)° °).°to°\!°²dstring²°()° °~° ²"%"²°;°
            °}°
            ¹else¹
            °{°
                height °~=° ²"vw"²°;°
            °}°
        °}°
        
        ¹if¹ °(° width °==° ²""² °)°
        °{°
            width °=° ²"auto"²°;°
        °}°
        ¹else¹ ¹if¹ °(° °\!°HasUnit°(° width °)° °)°
        °{°
            width °~=° ²"%"²°;°
        °}°
        
        image_text °~=° ²"\\" style=\\"height:"² °~° height °~° ²";width:"² °~° width °~° ²"\\"/&gt;"²°;°
        
        ¹return¹ image_text°;°
    °}°

    °// ~\~°
    
    ²dstring² ReplaceDefinitions°(°
        ²dstring² classes
        °)°
    °{°
        ²dstring²
            class_name°;°
        ²dstring²°[]°
            class_name_array°;°
        ²long²
            class_name_index°;°
            
        class_name_array °=° classes°.°split°(° ²' '² °);°
        
        ¹for¹ °(° class_name_index °=° ²0²°;°
              class_name_index °&lt;° class_name_array°.°length°;°
              °+\+°class_name_index °)°
        °{°
            class_name °=° class_name_array°[° class_name_index °];°
            
            ¹if¹ °(° °(° class_name in DefinitionMap °)° °\!°is ²null² °)°
            °{°
                class_name_array°[° class_name_index °]° °=° DefinitionMap°[° class_name °];°
            °}°
        °}°
            
        ¹return¹ class_name_array°.°join°(° ²' '² °);°
    °}°

    °// ~\~°

    ²void² ParseAttributes°(°
        ²dstring² classes°,°
        ²dstring² color_name
        °)°
    °{°
        ²dchar²
            character°;°
        ²long²
            next_character_index°;°
        ²dstring²
            found_classes°,°
            found_size°,°
            styles°;°
        ²dstring²°[]°
            part_array°;°
        
        attributes °=° ²""²°;°
                    
        styles °=° ²""²°;°

        ¹if¹ °(° character_index °+° ²3² °&lt;° text°.°length
             °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °)° °)°
             °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °+° ²1² °)° °)°
             °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °+° ²2² °)° °)° °)°
        °{°
            ¹if¹ °(° text°.°charAt°(° character_index °+° ²3² °)° °==° ²'\\\\'² °)°
            °{°
                styles °=° color_name °~° ²":\#"² °~° text°.°slice°(° character_index°,° character_index °+° ²3² °);° 

                character_index °+=° ²4²°;°
            °}°
            ¹else¹ ¹if¹ °(° character_index °+° ²3² °&lt;° text°.°length
                      °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °+° ²3² °)° °)°
                      °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °+° ²4² °)° °)°
                      °&&° IsHexadecimalCharacter°(° text°.°charAt°(° character_index °+° ²5² °)° °)°
                      °&&° text°.°charAt°(° character_index °+° ²6² °)° °==° ²'\\\\'² °)°
            °{°
                styles °=° color_name °~° ²":\#"² °~° text°.°slice°(° character_index°,° character_index °+° ²6² °);°

                character_index °+=° ²7²°;°
            °}°
        °}°
        
        ¹while¹ °(° character_index °+° ²2² °&lt;° text°.°length
             °&&° text°.°charAt°(° character_index °)° °==° ²'^'²
             °&&° IsAlphabeticalCharacter°(° text°.°charAt°(° character_index °+° ²1² °)° °)° °)°
        °{°
            found_classes °=° ²""²°;°
            
            ¹for¹ °(° next_character_index °=° character_index °+° ²1²°;°
                  next_character_index °&lt;° text°.°length°;°
                  °+\+°next_character_index °)°
            °{°
                character °=° text°.°charAt°(° next_character_index °);°
                
                ¹if¹ °(° IsAlphabeticalCharacter°(° character °)°
                     °||° IsDecimalCharacter°(° character °)°
                     °||° ²"_-=\°\¹\²\³"²°.°indexOf°(° character °)° °&gt;=° ²0² °)°
                °{°
                    found_classes °~=° character°;°
                °}°
                ¹else¹ ¹if¹ °(° character °==° ²'+'² °)°
                °{°
                    found_classes °~=° ²' '²°;°
                °}°
                ¹else¹ ¹if¹ °(° character °==° ²'\\\\'² °)°
                °{°        
                    ¹if¹ °(° found_classes °\!=° ²""² °)°
                    °{°
                        ¹if¹ °(° found_classes°.°indexOf°(° ²'='² °)° °&gt;=° ²0² °)°
                        °{°
                            part_array °=° found_classes°.°split°(° ²'='² °);°
                            DefinitionMap°[° part_array°[° ²1² °]° °]° °=° part_array°[° ²0² °];°
                            found_classes °=° part_array°[° ²0² °];°
                        °}°
                        
                        found_classes °=° ReplaceDefinitions°(° found_classes °);°
                        
                        ¹if¹ °(° classes °==° ²""² °)°
                        °{°
                            classes °=° found_classes°;°
                        °}°
                        ¹else¹
                        °{°
                            classes °~=° ²" "² °~° found_classes°;°
                        °}°
                        
                        character_index °=° next_character_index °+° ²1²°;°
                    °}°
                    
                    ¹break¹°;°
                °}°
                ¹else¹
                °{°
                    found_classes °=° ²""²°;°
                
                    ¹break¹°;°
                °}°
            °}°
            
            ¹if¹ °(° found_classes °==° ²""² °)°
            °{°
                ¹break¹°;°
            °}°
        °}°
        
        ¹if¹ °(° character_index °+° ²2² °&lt;° text°.°length
             °&&° text°.°charAt°(° character_index °)° °==° ²'^'²
             °&&° IsDecimalCharacter°(° text°.°charAt°(° character_index °+° ²1² °)° °)° °)°
        °{°
            found_size °=° ²""²°;°
            
            ¹for¹ °(° next_character_index °=° character_index °+° ²1²°;°
                  next_character_index °&lt;° text°.°length°;°
                  °+\+°next_character_index °)°
            °{°
                character °=° text°.°charAt°(° next_character_index °);°
                
                ¹if¹ °(° IsDecimalCharacter°(° character °)°
                     °||° character °==° ²'.'² °)°
                °{°
                    found_size °~=° character°;°
                °}°
                ¹else¹ ¹if¹ °(° character °==° ²'\\\\'² °)°
                °{°        
                    ¹if¹ °(° found_size °\!=° ²""² °)°
                    °{°
                        ¹if¹ °(° styles °\!=° ²""² °)°
                        °{°
                            styles °~=° ²";"²°;°
                        °}°
                        
                        styles °~=° ²"font-size:"² °~° found_size °~° ²"rem"²°;°
                        
                        character_index °=° next_character_index °+° ²1²°;°
                    °}°
                    
                    ¹break¹°;°
                °}°
                ¹else¹
                °{°
                    ¹break¹°;°
                °}°
            °}°
        °}°
        
        ¹if¹ °(° classes °\!=° ²""² °)°
        °{°
            attributes °~=° ²" class=\\""² °~° classes °~° ²"\\""²°;°
        °}°
        
        ¹if¹ °(° styles °\!=° ²""² °)°
        °{°
            attributes °~=° ²" style=\\""² °~° styles °~° ²"\\""²°;°
        °}°
    °}°

    °// ~\~°

    text °=° GetCleanedText°(° text °);°

    token_array °=° °[];°
    token_starts_line °=° ²true²°;°

    closing_tag °=° ²""²°;°

    it_is_in_pre °=° ²false²°;°
    it_is_in_blockquote °=° ²false²°;°
    it_is_in_frame_div °=° ²false²°;°
    it_is_in_box_div °=° ²false²°;°
    it_is_in_mark_span °=° ²false²°;°
    it_is_in_u °=° ²false²°;°
    it_is_in_left_div °=° ²false²°;°
    it_is_in_center_div °=° ²false²°;°
    it_is_in_right_div °=° ²false²°;°
    it_is_in_b °=° ²false²°;°
    it_is_in_i °=° ²false²°;°
    it_is_in_sup °=° ²false²°;°
    it_is_in_sub °=° ²false²°;°
    it_is_in_strike °=° ²false²°;°
    it_is_in_black_span °=° ²false²°;°
    it_is_in_cyan_span °=° ²false²°;°
    it_is_in_orange_span °=° ²false²°;°
    it_is_in_green_span °=° ²false²°;°
    it_is_in_gray_span °=° ²false²°;°
    it_is_in_pink_span °=° ²false²°;°
    it_is_in_red_span °=° ²false²°;°
    it_is_in_blue_span °=° ²false²°;°
    it_is_in_a °=° ²false²°;°

    table_count °=° ²0²°;°
    character_index °=° ²0²°;°

    ¹while¹ °(° character_index °&lt;° text°.°length °)°
    °{°
        token °=° ¹new¹ ²²TOKEN²²°;°
        token°.°StartsLine °=° token_starts_line°;°
        token_starts_line °=° ²false²°;°

        ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\\\\'²
             °&&° character_index °+° ²1² °&lt;° text°.°length °)°
        °{°
            token°.°Text °=° text°.°charAt°(° character_index °+° ²1² °).°to°\!°²dstring²°();°
            token°.°IsEscaped °=° ²true²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\`'² °)°
        °{°
            °+\+°character_index°;°

            ¹while¹ °(° character_index °&lt;° text°.°length °)°
            °{°
                ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\`'² °)°
                °{°
                    °+\+°character_index°;°

                    ¹break¹°;°
                °}°
                ¹else¹
                °{°
                    token°.°Text °~=° text°.°charAt°(° character_index °);°

                    °+\+°character_index°;°
                °}°
            °}°

            token°.°Text °=° token°.°Text°.°replace°(° ²"&lt;"²°,° ²"&lt;"² °).°replace°(° ²"&gt;"²°,° ²"&gt;"² °);°
            token°.°IsEscaped °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h1&gt;"²°;°
            closing_tag °=° ²"&lt;/h1&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"\!\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h2&gt;"²°;°
            closing_tag °=° ²"&lt;/h2&gt;"²°;°

            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²4² °)° °==° ²"\!\!\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h3&gt;"²°;°
            closing_tag °=° ²"&lt;/h3&gt;"²°;°

            character_index °+=° ²4²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²5² °)° °==° ²"\!\!\!\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h4&gt;"²°;°
            closing_tag °=° ²"&lt;/h4&gt;"²°;°

            character_index °+=° ²5²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²6² °)° °==° ²"\!\!\!\!\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h5&gt;"²°;°
            closing_tag °=° ²"&lt;/h5&gt;"²°;°

            character_index °+=° ²6²°;°
        °}°
        ¹else¹ ¹if¹ °(° token°.°StartsLine
                  °&&° text°.°slice°(° character_index°,° character_index °+° ²7² °)° °==° ²"\!\!\!\!\!\! "² °)°
        °{°
            token°.°Text °=° ²"&lt;h6&gt;"²°;°
            closing_tag °=° ²"&lt;/h6&gt;"²°;°

            character_index °+=° ²7²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"-\-\-"² °)°
        °{°
            token°.°Text °=° ²"&lt;hr/&gt;"²°;°

            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"~\~\~"² °)°
        °{°
            token°.°Text °=° ²"&lt;pb/&gt;"²°;°

            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'§'² °)°
        °{°
            token°.°Text °=° ²"&lt;br/&gt;"²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"[\[\["² °)°
        °{°
            °+\+°table_count°;°
            
            character_index °+=° ²3²°;°
            
            ParseAttributes°(° ²""²°,° ²"border-color"² °);°

            token°.°Text °=° ²"&lt;table"² °~° attributes °~° ²"&gt;&lt;tbody&gt;"²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"(("²
                  °&&° table_count °&gt;° ²0² °)°
        °{°
            character_index °+=° ²2²°;°
            
            ParseAttributes°(° ²""²°,° ²"background-color"² °);°
            
            token°.°Text °=° ²"&lt;tr&gt;&lt;td"² °~° attributes °~° ²"&gt;"²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'|'²
                  °&&° table_count °&gt;° ²0² °)°
        °{°
            °+\+°character_index°;°
            
            ParseAttributes°(° ²""²°,° ²"background-color"² °);°
            
            token°.°Text °=° ²"&lt;/td&gt;&lt;td"² °~° attributes °~° ²"&gt;"²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"))"²
                  °&&° table_count °&gt;° ²0² °)°
        °{°
            token°.°Text °=° ²"&lt;/td&gt;&lt;/tr&gt;"²°;°
            
            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"]\]\]"²
                  °&&° table_count °&gt;° ²0² °)°
        °{°
            °-\-°table_count°;°
            
            token°.°Text °=° ²"&lt;/tbody&gt;&lt;/table&gt;"²°;°
            
            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"[\["² °)°
        °{°
            token°.°Text °=° ParseImage°();°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²":\:\:"² °)°
        °{°
            it_is_in_pre °=° °\!°it_is_in_pre°;°

            token°.°Text °=° it_is_in_pre °?° ²"&lt;pre&gt;"² °:° ²"&lt;/pre&gt;"²°;°

            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"&gt;&gt;&gt;"² °)°
        °{°
            it_is_in_blockquote °=° °\!°it_is_in_blockquote°;°

            character_index °+=° ²3²°;°

            ¹if¹ °(° it_is_in_blockquote °)°
            °{°
                ParseAttributes°(° ²""²°,° ²"border-color"² °);°

                token°.°Text °=° ²"&lt;blockquote"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/blockquote&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"+\+\+"² °)°
        °{°
            it_is_in_frame_div °=° °\!°it_is_in_frame_div°;°

            character_index °+=° ²3²°;°

            ¹if¹ °(° it_is_in_frame_div °)°
            °{°
                ParseAttributes°(° ²"frame"²°,° ²"border-color"² °);°

                token°.°Text °=° ²"&lt;div"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/div&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"\#\#\#"² °)°
        °{°
            it_is_in_box_div °=° °\!°it_is_in_box_div°;°

            character_index °+=° ²3²°;°

            ¹if¹ °(° it_is_in_box_div °)°
            °{°
                ParseAttributes°(° ²"box"²°,° ²"background-color"² °);°

                token°.°Text °=° ²"&lt;div"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/div&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"{\{\{"² °)°
        °{°
            character_index °+=° ²3²°;°

            ParseAttributes°(° ²""²°,° ²"background-color"² °);°

            token°.°Text °=° ²"&lt;div"² °~° attributes °~° ²"&gt;"²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²3² °)° °==° ²"}\}\}"² °)°
        °{°
            token°.°Text °=° ²"&lt;/div&gt;"²°;°

            character_index °+=° ²3²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\#\#"² °)°
        °{°
            it_is_in_mark_span °=° °\!°it_is_in_mark_span°;°

            character_index °+=° ²2²°;°

            ¹if¹ °(° it_is_in_mark_span °)°
            °{°
                ParseAttributes°(° ²"mark"²°,° ²"background-color"² °);°

                token°.°Text °=° ²"&lt;span"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/span&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"_\_"² °)°
        °{°
            it_is_in_u °=° °\!°it_is_in_u°;°

            character_index °+=° ²2²°;°

            ¹if¹ °(° it_is_in_u °)°
            °{°
                ParseAttributes°(° ²""²°,° ²"text-decoration-color"² °);°

                token°.°Text °=° ²"&lt;u"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/u&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"{\{"² °)°
        °{°
            character_index °+=° ²2²°;°

            ParseAttributes°(° ²""²°,° ²"color"² °);°

            token°.°Text °=° ²"&lt;span"² °~° attributes °~° ²"&gt;"²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"}\}"² °)°
        °{°
            token°.°Text °=° ²"&lt;/span&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"&lt;&lt;"² °)°
        °{°
            it_is_in_left_div °=° °\!°it_is_in_left_div°;°

            token°.°Text °=° it_is_in_left_div °?° ²"&lt;div class=\\"left\\"&gt;"² °:° ²"&lt;/div&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"$\$"² °)°
        °{°
            it_is_in_center_div °=° °\!°it_is_in_center_div°;°

            token°.°Text °=° it_is_in_center_div °?° ²"&lt;div class=\\"center\\"&gt;"² °:° ²"&lt;/div&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"&gt;&gt;"² °)°
        °{°
            it_is_in_right_div °=° °\!°it_is_in_right_div°;°

            token°.°Text °=° it_is_in_right_div °?° ²"&lt;div class=\\"right\\"&gt;"² °:° ²"&lt;/div&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"*\*"² °)°
        °{°
            it_is_in_b °=° °\!°it_is_in_b°;°

            token°.°Text °=° it_is_in_b °?° ²"&lt;b&gt;"² °:° ²"&lt;/b&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"%\%"² °)°
        °{°
            it_is_in_i °=° °\!°it_is_in_i°;°

            token°.°Text °=° it_is_in_i °?° ²"&lt;i&gt;"² °:° ²"&lt;/i&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"^\^"² °)°
        °{°
            it_is_in_sup °=° °\!°it_is_in_sup°;°

            token°.°Text °=° it_is_in_sup °?° ²"&lt;sup&gt;"² °:° ²"&lt;/sup&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²",\,"² °)°
        °{°
            it_is_in_sub °=° °\!°it_is_in_sub°;°

            token°.°Text °=° it_is_in_sub °?° ²"&lt;sub&gt;"² °:° ²"&lt;/sub&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"~\~"² °)°
        °{°
            it_is_in_strike °=° °\!°it_is_in_strike°;°

            character_index °+=° ²2²°;°

            ¹if¹ °(° it_is_in_strike °)°
            °{°
                ParseAttributes°(° ²""²°,° ²"text-decoration-color"² °);°

                token°.°Text °=° ²"&lt;strike"² °~° attributes °~° ²"&gt;"²°;°
            °}°
            ¹else¹
            °{°
                token°.°Text °=° ²"&lt;/strike&gt;"²°;°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\°\°"²
                  °&&° °\!°it_is_in_gray_span °)°
        °{°
            it_is_in_black_span °=° °\!°it_is_in_black_span°;°

            token°.°Text °=° it_is_in_black_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\°\°"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\¹\¹"²
                  °&&° °\!°it_is_in_pink_span °)°
        °{°
            it_is_in_cyan_span °=° °\!°it_is_in_cyan_span°;°

            token°.°Text °=° it_is_in_cyan_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\¹\¹"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\²\²"²
                  °&&° °\!°it_is_in_red_span °)°
        °{°
            it_is_in_orange_span °=° °\!°it_is_in_orange_span°;°

            token°.°Text °=° it_is_in_orange_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\²\²"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\³\³"²
                  °&&° °\!°it_is_in_blue_span °)°
        °{°
            it_is_in_green_span °=° °\!°it_is_in_green_span°;°

            token°.°Text °=° it_is_in_green_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\³\³"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            character_index °+=° ²2²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\°'² °)°
        °{°
            it_is_in_gray_span °=° °\!°it_is_in_gray_span°;°

            token°.°Text °=° it_is_in_gray_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\°"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\¹'² °)°
        °{°
            it_is_in_pink_span °=° °\!°it_is_in_pink_span°;°

            token°.°Text °=° it_is_in_pink_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\¹"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\²'² °)°
        °{°
            it_is_in_red_span °=° °\!°it_is_in_red_span°;°

            token°.°Text °=° it_is_in_red_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\²"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\³'² °)°
        °{°
            it_is_in_blue_span °=° °\!°it_is_in_blue_span°;°

            token°.°Text °=° it_is_in_blue_span °?° ²"&lt;span class=\\""² °~° ReplaceDefinitions°(° ²"\³"² °)° °~° ²"\\"&gt;"² °:° ²"&lt;/span&gt;"²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²5² °)° °==° ²"&lt;pre&gt;"² °)°
        °{°
            token°.°Text °=° ²"&lt;pre&gt;"²°;°

            character_index °+=° ²5²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²6² °)° °==° ²"&lt;/pre&gt;"² °)°
        °{°
            token°.°Text °=° ²"&lt;/pre&gt;"²°;°

            character_index °+=° ²6²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\@\@"² °)°
        °{°
            it_is_in_a °=° °\!°it_is_in_a°;°

            token°.°Text °=° it_is_in_a °?° ²"&lt;a href=\\""² °:° ²"&lt;/a&gt;"²°;°

            character_index °+=° ²2²°;°

            ¹if¹ °(° it_is_in_a °)°
            °{°
                url °=° ²""²°;°

                ¹while¹ °(° character_index °&lt;° text°.°length °)°
                °{°
                    ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²' '² °)°
                    °{°
                        token°.°Text °~=° url °~° ²"\\"&gt;"²°;°

                        °+\+°character_index°;°

                        ¹break¹°;°
                    °}°
                    ¹else¹ ¹if¹ °(° text°.°slice°(° character_index°,° character_index °+° ²2² °)° °==° ²"\@\@"² °)°
                    °{°
                        it_is_in_a °=° ²false²°;°

                        token°.°Text °~=° url °~° ²"\\"&gt;"² °~° url °~° ²"&lt;/a&gt;"²°;°

                        character_index °+=° ²2²°;°

                        ¹break¹°;°
                    °}°
                    ¹else¹
                    °{°
                        url °~=° text°.°charAt°(° character_index °);°

                        °+\+°character_index°;°
                    °}°
                °}°
            °}°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²' '² °)°
        °{°
            token°.°Text °=° ²" "²°;°

            °+\+°character_index°;°

            ¹while¹ °(° character_index °&lt;° text°.°length
                    °&&° text°.°charAt°(° character_index °)° °==° ²' '² °)°
            °{°
                token°.°Text °~=° ²" "²°;°

                °+\+°character_index°;°
            °}°

            token°.°IsSpace °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° text°.°charAt°(° character_index °)° °==° ²'\\n'² °)°
        °{°
            ¹if¹ °(° closing_tag °\!=° ²""² °)°
            °{°
                closing_token °=° ¹new¹ ²²TOKEN²²°;°
                closing_token°.°Text °=° closing_tag°;°
                closing_tag °=° ²""²°;°

                token_array°.°push°(° closing_token °);°
            °}°

            token°.°Text °=° ²"\\n"²°;°
            token_starts_line °=° ²true²°;°

            °+\+°character_index°;°
        °}°
        ¹else¹
        °{°
            token°.°Text °=° text°.°charAt°(° character_index °).°to°\!°²dstring²°();°

            °+\+°character_index°;°
        °}°

        token_array°.°push°(° token °);°
    °}°

    ¹return¹ token_array°;°
°}°

°// ~\~°

²dstring² GetListTag°(°
    ref ²²TOKEN²²°[]° token_array°,°
    ²long² token_index
    °)°
°{°
    ²²TOKEN²²
        token°;°

    ¹if¹ °(° token_index °&gt;=° ²0²
         °&&° token_index °+° ²1² °&lt;° token_array°.°length
         °&&° °\!°token_array°[° token_index °+° ²1² °].°StartsLine
         °&&° token_array°[° token_index °+° ²1² °].°IsSpace
         °&&° token_array°[° token_index °+° ²1² °].°Text°.°length °==° IndentationSpaceCount °-° ²1² °)°
    °{°
        token °=° token_array°[° token_index °];°

        ¹if¹ °(° °\!°token°.°IsEscaped °)°
        °{°
            ¹if¹ °(° token°.°Text °==° ²"*"² °)°
            °{°
                ¹return¹ ²"ul"²°;°
            °}°
            ¹else¹ ¹if¹ °(° token°.°Text °==° ²"\#"² °)°
            °{°
                ¹return¹ ²"ol"²°;°
            °}°
        °}°
    °}°

    ¹return¹ ²null²°;°
°}°

°// ~\~°

²void² MakeLists°(°
    ref ²²TOKEN²²°[]° token_array
    °)°
°{°
    ²bool²
        it_is_in_pre°;°
    ²dstring²
        tag°,°
        tag_token_text°;°
    ²dstring²°[]°
        tag_array°;°
    ²long²
        tag_count°,°
        tag_token_index°,°
        token_index°;°
    ²²TOKEN²²
        tag_token°,°
        token°;°

    tag_array °=° °[];°

    it_is_in_pre °=° ²false²°;°

    ¹for¹ °(° token_index °=° ²0²°;°
          token_index °&lt;° token_array°.°length°;°
          °+\+°token_index °)°
    °{°
        token °=° token_array°[° token_index °];°

        ¹if¹ °(° it_is_in_pre °)°
        °{°
            ¹if¹ °(° token°.°Text °==° ²"&lt;/pre&gt;"² °)°
            °{°
                it_is_in_pre °=° ²false²°;°
            °}°
        °}°
        ¹else¹
        °{°
            ¹if¹ °(° token°.°Text °==° ²"&lt;pre&gt;"² °)°
            °{°
                it_is_in_pre °=° ²true²°;°
            °}°
            ¹else¹ ¹if¹ °(° token°.°StartsLine °)°
            °{°
                tag_token_index °=° token_index°;°
                tag_token °=° token°;°
                tag_count °=° ²-1²°;°
                tag °=° ²null²°;°

                ¹if¹ °(° token°.°IsSpace °)°
                °{°
                    tag °=° GetListTag°(° token_array°,° token_index °+° ²1² °);°

                    ¹if¹ °(° tag °\!°is ²null² °)°
                    °{°
                        tag_count °=° ²1² °+° °(° token°.°Text°.°length °/° IndentationSpaceCount °);°

                        °+\+°token_index°;°

                        tag_token_index °=° token_index°;°
                        tag_token °=° token_array°[° token_index °];°

                        tag_token°.°Text °=° ²""²°;°
                        token_array°[° token_index °+° ²1² °].°Text °=° ²""²°;°
                    °}°
                °}°
                ¹else¹
                °{°
                    tag °=° GetListTag°(° token_array°,° token_index °);°

                    ¹if¹ °(° tag °\!°is ²null² °)°
                    °{°
                        tag_count °=° ²1²°;°

                        tag_token°.°Text °=° ²""²°;°
                        token_array°[° token_index °+° ²1² °].°Text °=° ²""²°;°
                    °}°
                    ¹else¹ ¹if¹ °(° tag_array°.°length °&gt;° ²0² °)°
                    °{°
                        tag_count °=° ²0²°;°
                    °}°
                °}°

                ¹if¹ °(° tag_count °&gt;=° ²0² °)°
                °{°
                    tag_token_text °=° ²""²°;°

                    ¹if¹ °(° tag_count °&gt;° tag_array°.°length °)°
                    °{°
                        ¹while¹ °(° tag_count °&gt;° tag_array°.°length °)°
                        °{°
                            tag_array°.°push°(° tag °);°
                            tag_token_text °~=° ²"&lt;"² °~° tag °~° ²"&gt;&lt;li&gt;"²°;°
                        °}°
                    °}°
                    ¹else¹ ¹if¹ °(° tag_count °==° tag_array°.°length °)°
                    °{°
                        tag_token_text °~=° ²"&lt;/li&gt;&lt;li&gt;"²°;°
                    °}°
                    ¹else¹ ¹if¹ °(° tag_count °&lt;° tag_array°.°length °)°
                    °{°
                        ¹while¹ °(° tag_count °&lt;° tag_array°.°length °)°
                        °{°
                            tag_token_text °~=° ²"&lt;/li&gt;&lt;/"² °~° tag_array°.°pop°()° °~° ²"&gt;"²°;°
                        °}°

                        ¹if¹ °(° tag °\!°is ²null² °)°
                        °{°
                            tag_token_text °~=° ²"&lt;/li&gt;&lt;li&gt;"²°;°
                        °}°
                    °}°

                    ¹if¹ °(° tag_token_text °\!=° ²""² °)°
                    °{°
                        token °=° ¹new¹ ²²TOKEN²²°;°
                        token°.°Text °=° tag_token_text°;°
                        token_array°.°splice°(° tag_token_index°,° ²0²°,° token °);°

                        °+\+°token_index°;°
                    °}°
                °}°
            °}°
        °}°
    °}°
°}°

°// ~\~°

²void² MakeParagraphs°(°
    ref ²²TOKEN²²°[]° token_array
    °)°
°{°
    ²bool²
        it_is_in_pre°;°
    ²long²
        token_index°;°
    ²²TOKEN²²
        token°;°

    token °=° ¹new¹ ²²TOKEN²²°;°
    token°.°Text °=° ²"&lt;p&gt;"²°;°
    token_array°.°splice°(° ²0²°,° ²0²°,° token °);°

    it_is_in_pre °=° ²false²°;°

    ¹for¹ °(° token_index °=° ²0²°;°
          token_index °&lt;° token_array°.°length°;°
          °+\+°token_index °)°
    °{°
        token °=° token_array°[° token_index °];°

        ¹if¹ °(° it_is_in_pre °)°
        °{°
            ¹if¹ °(° token°.°Text °==° ²"&lt;/pre&gt;"² °)°
            °{°
                it_is_in_pre °=° ²false²°;°
            °}°
        °}°
        ¹else¹
        °{°
            ¹if¹ °(° token°.°Text °==° ²"&lt;pre&gt;"² °)°
            °{°
                it_is_in_pre °=° ²true²°;°
            °}°
            ¹else¹ ¹if¹ °(° token°.°StartsLine
                      °&&° token°.°Text °==° ²"\\n"² °)°
            °{°
                token°.°Text °=° ²"&lt;/p&gt;&lt;p&gt;\\n"²°;°
            °}°
        °}°
    °}°

    token °=° ¹new¹ ²²TOKEN²²°;°
    token°.°Text °=° ²"&lt;/p&gt;"²°;°
    token_array°.°push°(° token °);°
°}°

°// ~\~°

²void² MakeBreaks°(°
    ref ²²TOKEN²²°[]° token_array
    °)°
°{°
    ²bool²
        page_break_is_added°;°
    ²long²
        token_character_index°,°
        token_index°;°
    ²²TOKEN²²
        token°;°

    page_break_is_added °=° ²false²°;°

    ¹for¹ °(° token_index °=° ²0²°;°
          token_index °&lt;° token_array°.°length°;°
          °+\+°token_index °)°
    °{°
        token °=° token_array°[° token_index °];°

        ¹if¹ °(° token°.°Text °==° ²"&lt;pb/&gt;"² °)°
        °{°
            token°.°Text °=° ²""²°;°

            page_break_is_added °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° page_break_is_added
                  °&&° token°.°Text°.°length °&gt;=° ²3²
                  °&&° token°.°Text°.°startsWith°(° ²'&lt;'² °)°
                  °&&° °(° °\!°token°.°Text°.°startsWith°(° ²"&lt;/"² °)°
                       °||° token°.°Text °==° ²"&lt;/p&gt;&lt;p&gt;\\n"² °)° °)°
        °{°
            ¹if¹ °(° token°.°Text°.°endsWith°(° ²"&lt;/p&gt;&lt;p&gt;\\n"² °)° °)°
            °{°
                token_character_index °=° ²6²°;°
            °}°
            ¹else¹ ¹if¹ °(° token°.°Text°.°endsWith°(° ²"&gt;"² °)° °)°
            °{°
                token_character_index °=° token°.°Text°.°length°.°to°\!°²long²°()° °-° ²1²°;°
            °}°
            ¹else¹
            °{°
                token_character_index °=° token°.°Text°.°indexOf°(° ²' '² °);°
            °}°

            token°.°Text
                °=° token°.°Text°.°slice°(° ²0²°,° token_character_index °)°
                  °~° ²" style=\\"page-break-before: always\\""²
                  °~° token°.°Text°.°slice°(° token_character_index°,° token°.°Text°.°length °);°

            page_break_is_added °=° ²false²°;°
        °}°
    °}°
°}°

°// ~\~°

²dstring² GetText°(°
    ref ²²TOKEN²²°[]° token_array
    °)°
°{°
    ²dstring²
        text°;°
    ²long²
        token_index°;°

    text °=° ²""²°;°

    ¹for¹ °(° token_index °=° ²0²°;°
          token_index °&lt;° token_array°.°length°;°
          °+\+°token_index °)°
    °{°
        text °~=° token_array°[° token_index °].°Text°;°
    °}°

    ¹return¹ text°;°
°}°

°// ~\~°

²dstring² GetProcessedText°(°
    ²dstring² text
    °)°
°{°
    ²²TOKEN²²°[]°
        token_array°;°

    text °=° GetPreprocessedText°(° text °);°

    token_array °=° GetTokenArray°(° text °);°

    MakeLists°(° token_array °);°
    MakeParagraphs°(° token_array °);°
    MakeBreaks°(° token_array °);°

    ¹return¹ GetText°(° token_array °);°
°}°

°// ~\~°

²void² Process°(°
    °)°
°{°
    ²dstring²
        text°;°

    text °=° InputFilePath°.°readText°().°to°\!°²dstring²°();°

    ¹if¹ °(° ColorizeOptionIsEnabled °)°
    °{°
        text °=° text°.°GetColorizedText°(° InputFilePath°,° LanguageName °);°
    °}°

    ¹if¹ °(° ProcessOptionIsEnabled °)°
    °{°
        text °=° text°.°GetProcessedText°();°
    °}°

    ¹if¹ °(° ScriptOptionIsEnabled °)°
    °{°
        text
            °=° ²"&lt;xmp&gt;\\n"²
              °~° text
              °~° ²"&lt;/xmp&gt;\\n"²
              °~° ²"&lt;script src=\\""² °~° ScriptFolderPath°.°to°\!°²dstring²°()° °~° ²"pendown.js\\"&gt;&lt;/script&gt;\\n"²°;°
    °}°

    ¹if¹ °(° StyleOptionIsEnabled °)°
    °{°
        text
            °=° ²"&lt;meta charset=\\"utf8\\"/&gt;\\n"²
              °~° ²"&lt;link rel=\\"stylesheet\\" href=\\""² °~° StyleFolderPath°.°to°\!°²dstring²°()° °~° ²"pendown.css\\"&gt;\\n"²
              °~° text°;°
    °}°

    OutputFilePath°.°write°(° text°.°to°\!°²string²°()° °);°
°}°

°// ~\~°

²void² main°(°
    ²string²°[]° argument_array
    °)°
°{°
    ²string²
        option°;°

    argument_array °=° argument_array°[° ²1² °..° °$° °];°

    ColorizeOptionIsEnabled °=° ²false²°;°
    ProcessOptionIsEnabled °=° ²false²°;°
    ScriptOptionIsEnabled °=° ²false²°;°
    StyleOptionIsEnabled °=° ²false²°;°
    LanguageName °=° ²""²°;°
    
    TabulationSpaceCount °=° ²4²°;°
    IndentationSpaceCount °=° ²4²°;°    
    
    DefinitionMap°[° ²"\°\°"² °]° °=° ²"black"²°;°
    DefinitionMap°[° ²"\¹\¹"² °]° °=° ²"cyan"²°;°
    DefinitionMap°[° ²"\²\²"² °]° °=° ²"orange"²°;°
    DefinitionMap°[° ²"\³\³"² °]° °=° ²"green"²°;°
    DefinitionMap°[° ²"\°"² °]° °=° ²"gray"²°;°
    DefinitionMap°[° ²"\¹"² °]° °=° ²"pink"²°;°
    DefinitionMap°[° ²"\²"² °]° °=° ²"red"²°;°
    DefinitionMap°[° ²"\³"² °]° °=° ²"blue"²°;°
    
    PageOptionIsEnabled °=° ²false²°;°
    PageWidth °=° ²21.0²°;°
    PageHeight °=° ²29.7²°;°
    PageLeftMargin °=° ²2²°;°
    PageRightMargin °=° ²1²°;°
    PageTopMargin °=° ²1²°;°
    PageBottomMargin °=° ²1²°;°
    ScriptFolderPath °=° ²""²°;°
    StyleFolderPath °=° ²""²°;°

    ¹while¹ °(° argument_array°.°length °&gt;=° ²1²
            °&&° argument_array°[° ²0² °].°startsWith°(° ²"-\-"² °)° °)°
    °{°
        option °=° argument_array°[° ²0² °];°

        argument_array °=° argument_array°[° ²1² °..° °$° °];°

        ¹if¹ °(° option °==° ²"-\-colorize"² °)°
        °{°
            ColorizeOptionIsEnabled °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-process"² °)°
        °{°
            ProcessOptionIsEnabled °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-script"² °)°
        °{°
            ScriptOptionIsEnabled °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-style"² °)°
        °{°
            StyleOptionIsEnabled °=° ²true²°;°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-language"²
                  °&&° argument_array°.°length °&gt;=° ²1² °)°
        °{°
            LanguageName °=° argument_array°[° ²0² °];°

            argument_array °=° argument_array°[° ²1² °..° °$° °];°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-tabulation"²
                  °&&° argument_array°.°length °&gt;=° ²1² °)°
        °{°
            TabulationSpaceCount °=° argument_array°[° ²0² °].°to°\!°²long²°();°

            argument_array °=° argument_array°[° ²1² °..° °$° °];°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-indentation"²
                  °&&° argument_array°.°length °&gt;=° ²1² °)°
        °{°
            IndentationSpaceCount °=° argument_array°[° ²0² °].°to°\!°²long²°();°

            argument_array °=° argument_array°[° ²1² °..° °$° °];°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-page"²
                  °&&° argument_array°.°length °&gt;=° ²6² °)°
        °{°
            PageOptionIsEnabled °=° ²true²°;°
            
            PageWidth °=° argument_array°[° ²0² °].°to°\!°²double²°();°
            PageHeight °=° argument_array°[° ²1² °].°to°\!°²double²°();°
            PageLeftMargin °=° argument_array°[° ²2² °].°to°\!°²double²°();°
            PageRightMargin °=° argument_array°[° ²3² °].°to°\!°²double²°();°
            PageTopMargin °=° argument_array°[° ²4² °].°to°\!°²double²°();°
            PageBottomMargin °=° argument_array°[° ²5² °].°to°\!°²double²°();°

            argument_array °=° argument_array°[° ²6² °..° °$° °];°
        °}°
        ¹else¹ ¹if¹ °(° option °==° ²"-\-path"²
                  °&&° argument_array°.°length °&gt;=° ²1²
                  °&&° argument_array°[° ²0² °].°endsWith°(° ²'/'² °)° °)°
        °{°
            ScriptFolderPath °=° argument_array°[° ²0² °];°
            StyleFolderPath °=° argument_array°[° ²0² °];°

            argument_array °=° argument_array°[° ²1² °..° °$° °];°
        °}°
        ¹else¹
        °{°
            Abort°(° ²"Invalid option : "² °~° option °);°
        °}°
    °}°

    ¹if¹ °(° argument_array°.°length °==° ²2² °)°
    °{°
        InputFilePath °=° argument_array°[° ²0² °];°
        OutputFilePath °=° argument_array°[° ²1² °];°

        Process°();°
    °}°
    ¹else¹
    °{°
        writeln°(° ²"Usage :"² °);°
        writeln°(° ²"    pendown [options] input_file output_file"² °);°
        writeln°(° ²"Options :"² °);°
        writeln°(° ²"    -\-colorize"² °);°
        writeln°(° ²"    -\-process"² °);°
        writeln°(° ²"    -\-script"² °);°
        writeln°(° ²"    -\-style"² °);°
        writeln°(° ²"    -\-language c|c+\+|cpp|c\#|cs|d|java|js|ts"² °);°
        writeln°(° ²"    -\-tabulation 4"² °);°
        writeln°(° ²"    -\-indentation 4"² °);°
        writeln°(° ²"    -\-page 21 29.7 2 1 1 1"² °);°
        writeln°(° ²"    -\-path PENDOWN_FOLDER/"² °);°
        writeln°(° ²"Examples :"² °);°
        writeln°(° ²"    pendown -\-process -\-style -\-path ../ document.pd document.html"² °);°
        writeln°(° ²"    pendown -\-process -\-loadable -\-style -\-path ../ document.pd document.html"² °);°
        writeln°(° ²"    pendown -\-process -\-style -\-path ../ document.pd document.html"² °);°
        writeln°(° ²"    pendown -\-colorize code.d code.pd"² °);°
        writeln°(° ²"    pendown -\-colorize -\-process -\-style -\-path ../ code.d code.html"² °);°
        writeln°(° ²"    pendown -\-colorize -\-script -\-style -\-path ../ code.d code.html"² °);°

        Abort°(° ²"Invalid arguments : "² °~° argument_array°.°to°\!°²string²°()° °);°
    °}°
°}°
:::
</xmp>
<script src="../pendown.js"></script>
